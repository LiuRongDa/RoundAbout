<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1" />
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Pragma" content="no-cache">
    <meta name="renderer" content="webkit">
    <title>基本资料</title>
    <meta name="keywords" content="WeCenter3.31仿知乎模板">
    <meta name="description" content="WeCenter仿知乎模板，支持WeCenter3.31，WeCenter3.32，WeCenter3.33">
    <base href="http://localhost:8088/springboot/">
    <!--[if IE]></base><![endif]-->
    <link href="css/azhihu/img/favicon.ico?v=20200516" rel="shortcut icon" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/icon.css">
    <link href="css/default/common.css?v=20200516" rel="stylesheet" type="text/css" />
    <link href="css/default/link.css?v=20200516" rel="stylesheet" type="text/css" />
    <link href="js/plug_module/style.css?v=20200516" rel="stylesheet" type="text/css" />
    <link href="css/user-setting.css" rel="stylesheet" type="text/css">
    <link href="css/azhihu/azhihu.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="js/highlight/styles/tomorrow.css">
    <script src="js/hm.js"></script>
    <script type="text/javascript">
        var _EEE69DFCFAFA3FCC102E61EF6227535E = "7343be5318c167b2ef5e1cb87e5b8a60";
        var G_POST_HASH = _EEE69DFCFAFA3FCC102E61EF6227535E;
        var G_INDEX_SCRIPT = "?/";
        //var G_SITE_NAME = "WeCenter仿知乎模板";
        var G_BASE_URL = "http://localhost:8088/springboot";
        //var G_STATIC_URL = "http://azhihu.cssroom.com/static";
        //var G_UPLOAD_URL = "http://azhihu.cssroom.com/uploads";
        var G_USER_ID = "108";
        var G_USER_NAME = "a123";
        var G_UPLOAD_ENABLE = "N";
        var G_UNREAD_NOTIFICATION = 0;
        var G_NOTIFICATION_INTERVAL = 100000;
        var G_CAN_CREATE_TOPIC = "";
        var G_ADVANCED_EDITOR_ENABLE = "Y";
        var FILE_TYPES = "jpg,jpeg,png,gif,zip,doc,docx,rar,pdf,psd";
        var G_DRAFT_ENABLED = "N";
        var G_PER_PAGE = "10";
        var G_INDEX_PER_PAGE = "20";
        var G_PRIVATEKEY = "pvjxzjmzvewfscft";
        var G_IV = "qvibvaiwgouxwjeu";
        var G_QUICK_PUBLISH_HUMAN_VALID = "0";
        var editor_type = "wangeditor";
    </script>
    <script src="js/jquery.2.js" type="text/javascript"></script>
    <script src="js/jquery.form.js" type="text/javascript"></script>
    <script src="js/plug_module/plug-in_module.js" type="text/javascript"></script>
    <script src="js/aws.js" type="text/javascript"></script>
    <script src="js/aw_template.js" type="text/javascript"></script>
    <script src="js/layer/layer.js" type="text/javascript"></script>
    <link rel="stylesheet" href="js/layer/theme/default/layer.css" id="layuicss-layer">
    <!--<script src="js/app.js" type="text/javascript"></script>-->
    <script src="js/fileupload.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/compatibility.js"></script>
    <script type="text/javascript" src="js/laydate/laydate.js"></script>
    <link rel="stylesheet" href="js/laydate/theme/default/laydate.css" id="layuicss-laydate">
    <script type="text/javascript" src="js/slide_captcha/gt.js"></script>
    <script src="js/crypto-js.js"></script>
    <script src="js/highlight/highlight.pack.js"></script>
    <script src="js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="js/toastr.min.js"></script>
    <link href="css/toastr.min.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript">
        toastr.options.positionClass = 'toast-center-center';
        toastr.options.showDuration = '1000';
        toastr.options.hideDuration = '3000';
        toastr.options.timeOut = '1500';
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre').forEach((block) => {
                hljs.highlightBlock(block);
        });
        });
    </script>
    <style type="text/css">
        .geetest_radar_tip_content {
            position: initial !important;
        }
    </style>
    <!--[if lte IE 8]>
    <script type="text/javascript" src="js/respond.js"></script>
    <![endif]-->
    <!--头部公共注入钩子-->
    <!--end头部公共注入钩子-->
    <style type="text/css">
        .fancybox-margin {
            margin-right: 17px;
        }
    </style>
</head>
<body class="vsc-initialized"><noscript unselectable="on" id="noscript">
    <div class="aw-404 aw-404-wrap container">
        <img src="common/no-js.jpg">
        <p>你的浏览器禁用了JavaScript, 请开启后刷新浏览器获得更好的体验!</p>
    </div>
</noscript>
<div class="aw-top-menu-wrap">
    <div class="container" style="padding-right:0px;">
        <!-- logo -->
        <div class="aw-logo hidden-xs">
            <a href="http://azhihu.cssroom.com">
                <img src="http://azhihu.cssroom.com/uploads/logo/20200525/logo_(1).png"  height="40">
            </a>
        </div>
        <!-- end logo -->
        <!-- 导航 -->
        <div class="aw-top-nav navbar">
            <div class="navbar-header">
                <button  class="navbar-toggle pull-left">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <nav role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
                <ul class="nav navbar-nav">
                    <li>
                        <a th:href="@{Reception/tb_Article/queryAll}"><i class=""></i> 首页</a>
                    </li>
                    <li>
                        <a th:href="@{Reception/tb_Topic/showColumn}"><i class=""></i> 专栏</a>
                    </li>
                </ul>
            </nav>
        </div>
        <!-- end 导航 -->
        <!-- 搜索框 -->
        <div class="aw-search-box  hidden-xs hidden-sm">
            <form class="navbar-search" action="Reception/tb_Article/queryLike" id="global_search_form" method="post">
                <input class="form-control search-query" type="text" value="" name="like"/>
                <span title="搜索" id="global_search_btns" onClick="$('#global_search_form').submit();">
                    <i class="icon icon-search"></i>
                </span>
            </form>
        </div>
        <!-- end 搜索框 -->
        <!-- 发起 -->
        <!--<div class="aw-publish-btn">
            <a id="header_publish" class="btn-primary" href="http://azhihu.cssroom.com/?/publish/" onclick="AWS.dialog('publish', {'category_enable':'0', 'category_id':'0', 'topic_title':''}); return false;">发起</a>
            <div class="dropdown-list pull-right">
                <ul>
                    <li>
                        <form method="post" action="http://azhihu.cssroom.com/?/publish/">
                            <a onclick="$(this).parents('form').submit();">问题</a>
                        </form>
                    </li>
                </ul>
            </div>
        </div>-->
        <!-- end 发起 -->
        <!-- 用户栏 -->
        <div class="aw-user-nav">
            <!-- 登陆&注册栏 -->
            <!--<a href="User/toOneHome" class="aw-user-nav-dropdown"></a>-->
            <img th:alt="${session.user.user_name}" th:src="${session.user.user_photo}" />

            <div class="aw-dropdown dropdown-list pull-right">
                <ul class="aw-dropdown-list">
                    <li class="hidden-xs"><a href="Reception/User/toOneHome"><i class="icon icon-draft"></i>
                        个人主页</a></li>
                    <li><a href="http://azhihu.cssroom.com/?/inbox/"><i class="icon icon-inbox"></i> 私信<span class="badge badge-important collapse" id="inbox_unread">0</span></a></li>
                    <li class="hidden-xs"><a href="Reception/User/toChangePwd"><i class="icon icon-setting"></i> 设置</a></li>
                    <!-- <li id="changeSkin"><a href="javascript:void(0);"><i class="icon icon-skin"></i> 换肤</a></li> -->
                    <li><a href="Reception/L/exit"><i class="icon icon-logout"></i> 退出</a></li>
                </ul>
            </div>
            <!-- <div class="aw-dropdown dropdown-list pull-right" id="skinList" style="left: 100%;top:200%;display: none">
                <ul class="aw-dropdown-list">
                    <li><a href="http://azhihu.cssroom.com/?/account/change_skin/?type=common"><i class="icon icon-draft"></i> 默认&nbsp;&nbsp;√</a></li>
                    <li><a href="http://azhihu.cssroom.com/?/account/change_skin/?type=green"><i class="icon icon-draft"></i> 绿色&nbsp;&nbsp;</a></li>
                    <li><a href="http://azhihu.cssroom.com/?/account/change_skin/?type=orange"><i class="icon icon-draft"></i> 橙色&nbsp;&nbsp;</a></li>
                </ul>
            </div> -->
            <!-- end 登陆&注册栏 -->
        </div>
        <!-- end 用户栏 -->

    </div>
</div>

<script>
    $(function () {
        var $changeSkin = $("#changeSkin"), $skinList = $("#skinList");
        $changeSkin.mouseenter(function () {
            $skinList.stop(true,true).show();
        });
        $changeSkin.mouseleave(function (e) {
            $skinList.hide();
        });
        $skinList.mouseover(function () {
            $(this).stop(true,true).show();
        });
        $skinList.mouseleave(function (e) {
            $(this).hide();
        })
    })
</script>
<div class="aw-container-wrap">
    <div class="container">
        <div class="row">
            <div class="aw-content-wrap clearfix">
                <div class="aw-user-setting bgw">
                    <div class="tabbable">
                        <ul class="nav nav-tabs aw-nav-tabs active">
                            <li ><a href="Reception/User/toChangePwd">密码设置</a></li>
                            <li class="active"><a href="Reception/User/toMessage">邮箱设置</a></li>

                            <h2><i class="icon icon-setting"></i> 用户设置</h2>
                        </ul>
                    </div>
                    <div class="tab-content clearfix" >
                        <div class="aw-mod">
                            <div class="mod-body">
                                <div class="aw-mod aw-user-setting-bind">
                                    <div class="mod-head">
                                        <h3>修改邮箱</h3>
                                    </div>
                                    <form class="form-horizontal" method="post" id="setting_form">
                                        <div class="mod-body">
                                            <div class="form-group">
                                                <label class="control-label">当前邮箱</label>
                                                <div class="row">
                                                    <div class="col-lg-4">
                                                        <input type="text" class="form-control" id="email" name="email" readonly  th:value="${session.user.user_email}" style="margin-bottom: 10px">
                                                        <input type="text" class="form-control" style="width: 175px;" id="random">
                                                        <button type="button" class="btn"  id="second" style="width: 90px;margin: -66px 0 0 190px">获取验证码</button>
                                                        <input id="span" hidden>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label" >新的邮箱</label>
                                                <div class="row">
                                                    <div class="col-lg-4">
                                                        <input type="text" class="form-control" id="newemail" name="newemail" style="margin-bottom: 10px">
                                                        <input type="text" class="form-control" style="width: 175px;" id="newrandom">
                                                        <button type="button" class="btn"  id="seconds" style="width: 90px;margin: -66px 0 0 190px" >获取验证码</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="mod-footer clearfix">
                                    <a href="javascript:;" class="btn btn-large btn-success pull-right" onclick="sub()">保存</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function sub(){
            if ($("#random").val()!=$("#newrandom").val() || $("#newrandom").val()==$("span").val()){
                $.ajax({
                    type:'post',
                    data:{email:$("#newemail").val()},
                    url:'Reception/User/setEmail',
                    success:function (dt) {
                        window.location.href="Reception/User/toMessage"
                    }
                })
            } else
                toastr.warning("验证码错误")
        }
        $("#second").click(function (){
                byemail($("#email").val(),0);
                if ($("#id").val()!='')
                    setTime($("#second"));//开始倒计时
        });
        $("#seconds").click(function (){
            if ($("#span").val()==$("#random").val()){
                $("#random").prop('disabled', true);
                $("#second").prop('disabled', true);
                if (boolean_email()){
                    byemail($("#newemail").val(),1);
                    if ($("#id").val()!='')
                        setTime($("#seconds"));//开始倒计时
                }
            }
        });
        function next_setpwd() {
            if ($("#random").val()!='') {
                if ($("#span").val()==$("#random").val()){
                    $("#one").hide();
                    $("#two").show();
                } else{
                    toastr.error("验证码输入错误")
                }
            }else
                toastr.error("验证码不能为空")
        }
        function boolean_email(){
            var email = /^\w+@\w+(\.\w+){1,3}$/;
            if (email.test($("#newemail").val())){
                return true;
            }else{
                toastr.warning("邮箱格式不正确");
                return false;
            }
        }
        function byemail(email,sta) {
            $.ajax({
                type:"post",
                data:{email:email},
                url:"Reception/User/byEmail",
                async:false,
                success:function (da) {
                    //console.log(da)
                    var number = da.indexOf("_");
                    if (sta==0)
                        $("#span").val(da.substring(number+1));
                    else{
                        if(number != -1){
                            toastr.warning("邮箱已存在")
                            return
                        }else
                            $("#span").val(da.substring(number+1));
                    }
                }
            })
        }
        //60s倒计时实现逻辑
        var countdown = 60;
        function setTime(obj) {
            if (countdown == 0) {
                obj.prop('disabled', false);
                obj.text("获取验证码");
                countdown = 60;//60秒过后button上的文字初始化,计时器初始化;
                return;
            } else {
                obj.prop('disabled', true);
                obj.text("("+countdown+"s)") ;
                countdown--;
            }
            setTimeout(function() { setTime(obj) },1000) //每1000毫秒执行一次
        }
    </script>
</div><div class="aw-footer-wrap">
    <div class="aw-footer">
        Copyright © 2020, All Rights Reserved
        <span class="hidden-xs">Powered By <a href="http://www.wecenter.com/?copyright" target="blank">WeCenter 3.5.1</a></span>
    </div>
</div>
<!---->
</body></html>
<!DOCTYPE html>
<html>
<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1" />
    <meta http-equiv="Expires" CONTENT="0">
    <meta http-equiv="Cache-Control" CONTENT="no-cache">
    <meta http-equiv="Pragma" CONTENT="no-cache">
    <meta name="renderer" content="webkit" />
    <title>注册</title>
    <meta name="keywords" content="WeCenter3.31仿知乎模板" />
    <meta name="description" content="WeCenter仿知乎模板，支持WeCenter3.31，WeCenter3.32，WeCenter3.33"  />
    <base href="http://localhost:8088/springboot/" /><!--[if IE]></base><![endif]-->
    <link href="css/azhihu/img/favicon.ico?v=20200516" rel="shortcut icon" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/icon.css" />
    <link href="css/default/common.css?v=20200516" rel="stylesheet" type="text/css" />
    <link href="css/default/link.css?v=20200516" rel="stylesheet" type="text/css" />
    <link href="js/plug_module/style.css?v=20200516" rel="stylesheet" type="text/css" />
    <link href="css/default/register.css?v=20200516" rel="stylesheet" type="text/css" />
    <link href="css/azhihu/azhihu.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="js/highlight/styles/tomorrow.css">
    <script type="text/javascript">
        var _1147EE59C2EAF626C82066D5B32FD65B="";
        var G_POST_HASH=_1147EE59C2EAF626C82066D5B32FD65B;
        var G_INDEX_SCRIPT = "?/";
        //var G_SITE_NAME = "WeCenter仿知乎模板";
        var G_BASE_URL = "http://localhost:8088/springboot";
        //var G_STATIC_URL = "http://azhihu.cssroom.com/static";
        //var G_UPLOAD_URL = "http://azhihu.cssroom.com/uploads";
        var G_USER_ID = "";
        var G_USER_NAME = "";
        var G_UPLOAD_ENABLE = "N";
        var G_UNREAD_NOTIFICATION = 0;
        var G_NOTIFICATION_INTERVAL = 100000;
        var G_CAN_CREATE_TOPIC = "";
        var G_ADVANCED_EDITOR_ENABLE = "Y";
        var FILE_TYPES = "jpg,jpeg,png,gif,zip,doc,docx,rar,pdf,psd";
        var G_DRAFT_ENABLED = "N";
        var G_PER_PAGE = "10";
        var G_INDEX_PER_PAGE = "20";
        var G_PRIVATEKEY = "pvjxzjmzvewfscft";
        var G_IV = "qvibvaiwgouxwjeu";
        var G_QUICK_PUBLISH_HUMAN_VALID = "0";
        var editor_type="wangeditor";
    </script>
    <script src="js/jquery.2.js?v=20200516" type="text/javascript"></script>
    <script src="js/jquery.form.js?v=20200516" type="text/javascript"></script>
    <script src="js/plug_module/plug-in_module.js?v=20200516" type="text/javascript"></script>
    <script src="js/aws.js?v=20200516" type="text/javascript"></script>
    <script src="js/aw_template.js?v=20200516" type="text/javascript"></script>
    <script src="js/layer/layer.js?v=20200516" type="text/javascript"></script>
    <script src="js/app.js?v=20200516" type="text/javascript"></script>
    <script type="text/javascript" src="js/compatibility.js"></script>
    <script type="text/javascript" src="js/laydate/laydate.js"></script>
    <script type="text/javascript" src="js/slide_captcha/gt.js"></script>
    <script src="js/crypto-js.js"></script>
    <script src="js/highlight/highlight.pack.js"></script>
    <script src="js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="js/toastr.min.js"></script>
    <link href="css/toastr.min.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript">
        toastr.options.positionClass = 'toast-center-center';
        toastr.options.showDuration = '1000';
        toastr.options.hideDuration = '3000';
        toastr.options.timeOut = '1500';
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre').forEach((block) => {
                hljs.highlightBlock(block);
            });
        });
    </script>
    <style type="text/css">
        .geetest_radar_tip_content{
            position: initial !important;
        }
    </style>
    <!--[if lte IE 8]>
    <script type="text/javascript" src="js/respond.js"></script>
    <![endif]-->
    <!--头部公共注入钩子-->
    <!--end头部公共注入钩子-->
</head>
<noscript unselectable="on" id="noscript">
    <div class="aw-404 aw-404-wrap container">
        <img src="http://azhihu.cssroom.com/static/common/no-js.jpg">
        <p>你的浏览器禁用了JavaScript, 请开启后刷新浏览器获得更好的体验!</p>
    </div>
</noscript><style type="text/css">
    .oldPwdTip {
        position: absolute;
        color: rgba(153, 153, 153, 1);
        margin-top: 6px;
        margin-left: 0px;
        text-align: left;
        left: 0px;
        top: -5px;
        padding: 0 15px;
        width: 100%;
        height: 40px;
        line-height: 38px;
        color: #777777;
    }
    body {
        background-image: url(css/azhihu/img/login_bg.png);
        background-repeat: no-repeat;
        background-color: #b8e5f8;
        background-size: cover;
        width: 100%;
        height: 100vh;
        overflow: auto;
        padding-right: 15px;
    }
    .aw-register-box {
        width: 432px;
        margin: 0 auto;
        background-color: #fff;
        border: 0;
        border-radius: 2px;
        -webkit-box-shadow: 0 1px 3px rgba(26,26,26,.1);
        box-shadow: 0 1px 3px rgba(26,26,26,.1);
        margin-top:100px;
    }
    .aw-register-box .logo{
        margin:0 auto;
    }
    .aw-register-box h1{
        text-align:center;
        color: #0084ff;
        font-size: 22px;
        margin: 13px 0 0;
    }
    .aw-register-box .mod-body .form-control {
        border: 0;
        border-bottom: 1px solid #e6e6e6;
        border-radius: 0;
    }
    .btn-blue{
        background-color: #0084ff;
    }
    .aw-footer,.aw-footer-wrap a{
        color:#fff;
    }
    @media (max-width: 769px){
        .aw-register-box{
            width: 100%;
            margin-top: 20px;
            margin-left: 10px;
        }
        .aw-register-box .mod-body {
            padding: 50px 10px;
        }
    }
</style>
<div class="aw-register-box">
    <div class="mod-head">
        <a href=""><img src="css/azhihu/img/login_logo.png" alt="" /></a>
        <h1>注册新用户</h1>
    </div>
    <div class="mod-body">
        <form class="aw-register-form" id="register_form">
            <ul>
                <li class="alert alert-danger collapse error_message text-left">
                    <i class="icon icon-delete"></i> <em></em>
                </li>
                <li>
                    <input class="aw-register-email form-control" type="text" placeholder="邮箱" name="email" tips="请输入你常用的电子邮箱作为你的账号" value="" errortips="邮箱格式不正确" />
                </li>
                <li>
                    <label class="oldPwdTip aw-register-pwd-label" onclick="$(this).hide();$('#aw-register-pwd').focus();">密码</label>
                    <input class="aw-register-pwd form-control" id='aw-register-pwd' name="password" type="password" tips="请输入 6-16 个字符,区分大小写" errortips="密码不符合规则" onfocus="hideOldPwdTip('aw-register-pwd');" onblur="toggleOldPwdTip('aw-register-pwd',this.value);"/>
                    <input id="aw-login-user-repassword" type="hidden" name="password" />
                </li>
                <li class="aw-register-verify">
                    <!--style="background-color: #92B8B1;" class="pull-right" id="captcha"-->
                    <button type="button" id="second" class="pull-right" style="width: 100px;height: 40px;border-radius: 15px;background-color:#bce8f1;opacity:0.9;outline: none;-webkit-text-fill-color: black;font-weight: 900" value="123">获取验证码</button>
                    <input type="text" id="random" class="form-control" name="seccode_verify" placeholder="验证码" />
                    <input type="text" id="span" hidden>
                </li>
                <li class="last">
                    <label><input type="checkbox" id="cb" value="agree" name="agreement_chk" /> 我同意</label>
                    <a href="javascript:;" class="aw-agreement-btn">用户协议</a>
                    <a href="login.html" class="pull-right">已有账号?</a>
                    <!-- <a style="margin-right:8px;" href="http://azhihu.cssroom.com/?/account/register/type-email" class="pull-right">邮箱注册</a> -->
                </li>
                <li class="clearfix">
                    <input type="button" class="btn btn-large btn-blue btn-block" value="注册" onclick="zc()">
                </li>
            </ul>
        </form>
    </div>
    <div class="mod-footer"></div>
</div>
<script type="text/javascript">
    function zc(){
        if (yemail()){
            if (ypwd()) {
                console.log($("#cb").is(":checked"));
                if ($("#random").val() == $("#span").val()) {
                    if ($("#cb").is(":checked")){
                        //alert("注册")
                        $.ajax({
                            type:"post",
                            data:{email:$("[name=email]").val(),pwd:$("[name=password]").val()},
                            url:"Reception/L/toRegister",
                            async:true,
                            success:function (da) {
                                console.log(da)
                                if (da){
                                    $.ajax({
                                        type:"post",
                                        data:{email:$("[name=email]").val(),pwd:$("[name=password]").val()},
                                        url:"Reception/L/toLogin",
                                        async:true,
                                        success:function (da) {
                                            console.log(da)
                                            if (da){
                                                window.location.href="Reception/tb_Article/queryAll";
                                            }else
                                                toastr.error("注册失败")
                                        }
                                    })
                                }else
                                    toastr.error("注册失败")
                            }
                        })
                    }else
                        toastr.error("请选择我同意用户协议")
                } else {
                    toastr.error("验证码不正确")
                }
            }
        }
    }

    $("#second").click(function (){
        if ( yemail()){
            byemail();
            if ($("#span").val()!='')
                setTime($("#second"));//开始倒计时
            else
                toastr.error("邮箱已存在")
        }
    });
    //查询邮箱是否存在
    function byemail() {
        $.ajax({
            type:"post",
            data:{email:$("[name=email]").val()},
            url:"Reception/User/byEmail",
            async:false,
            success:function (da) {
                var a = da.indexOf("_");
                if (a<0)
                $("#span").val(da);
            }
        })
    }

    //60s倒计时实现逻辑
    var countdown = 60;
    function setTime(obj) {
        if (countdown == 0) {
            obj.prop('disabled', false);
            obj.text("获取验证码");
            countdown = 60;//60秒过后button上的文字初始化,计时器初始化;
            return;
        } else {
            obj.prop('disabled', true);
            obj.text("("+countdown+"s)") ;
            countdown--;
        }
        setTimeout(function() { setTime(obj) },1000) //每1000毫秒执行一次
    }
    //验证email
    function yemail(){
        $("[name=email]").trigger("blur");
        if ($("[name=email]").parent().find(".no").length>0)
            return false;
        else{
            return true;
        }
    }
    //验证密码
    function ypwd(){
        $("[name=password]").trigger("blur");
        if ($("[name=password]").parent().find(".no").length>0)
            return false;
        else{
            return true;
        }
    }
    $(document).ready(function ()
    {
        verify_register_form('#register_form');
        /* 注册页面验证 */
        function verify_register_form(element){
            $(element).find('[type=text], [type=password]').on({
                focus : function(){
                    if (typeof $(this).attr('tips') != 'undefined' && $(this).attr('tips') != '')
                    {
                        $(this).parent().append('<b class="aw-reg-tips">' + $(this).attr('tips') + '</b>');
                    }
                },
                blur : function(){
                    if ($(this).attr('tips') != ''){
                        switch ($(this).attr('name')){
                            case 'email' :
                                $(this).parent().find('.aw-reg-tips').detach();
                                var emailreg = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
                                if (!emailreg.test($(this).val())){
                                    $(this).parent().find('.aw-reg-tips').detach();
                                    $(this).parent().append('<b class="aw-reg-tips aw-reg-err"><span class="no"></span><i class="aw-icon i-err"></i>' + $(this).attr('errortips') + '</b>');
                                    return;
                                }else{
                                    $(this).parent().find('.aw-reg-tips').detach();
                                    $(this).parent().append('<b class="aw-reg-tips aw-reg-right"><span class="ok"></span><i class="aw-icon i-followed"></i></b>');
                                }
                                return;
                            case 'password' :
                                $(this).parent().find('.aw-reg-tips').detach();
                                if ($(this).val().length >= 0 && $(this).val().length < 6){
                                    $(this).parent().find('.aw-reg-tips').detach();
                                    $(this).parent().append('<b class="aw-reg-tips aw-reg-err"><span class="no"></span><i class="aw-icon i-err"></i>' + $(this).attr('errortips') + '</b>');
                                    return;
                                }if ($(this).val().length > 17){
                                    $(this).parent().find('.aw-reg-tips').detach();
                                    $(this).parent().append('<b class="aw-reg-tips aw-reg-err"><span class="no"></span><i class="aw-icon i-err"></i>' + $(this).attr('errortips') + '</b>');
                                    return;
                                }else{
                                    $(this).parent().find('.aw-reg-tips').detach();
                                    $(this).parent().append('<b class="aw-reg-tips aw-reg-right"><span class="ok"></span><i class="aw-icon i-followed"></i></b>');
                                }
                                return;
                        }
                    }

                }
            });
        }
    });
</script>

<div class="aw-footer-wrap">
    <div class="aw-footer">
        Copyright © 2020, All Rights Reserved</span>
        <span class="hidden-xs">Powered By <a href="http://www.wecenter.com/?copyright" target="blank">WeCenter 3.5.1</a></span>
    </div>
</div>
</body>
<!---->
</html>